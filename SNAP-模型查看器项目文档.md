# SNAP 3D模型查看器项目文档

## 1. 项目概述

### 1.1 项目简介
SNAP 3D模型查看器是一款基于Electron、Vue 3和Three.js开发的桌面应用程序，主要用于查看、交互操作3D模型，以及进行相关的可视化分析工作。该应用程序支持多种3D模型格式，提供丰富的交互功能和分析工具，适用于工程设计、产品展示、教育培训等多个领域。

### 1.2 项目背景
本项目由三顾海事科技开发，主要面向AMS（船舶管理系统）领域，用于船舶数字孪生展示和交互。系统集成了船舶3D模型查看、数据监控和分析功能，为船舶管理和操作提供直观可视化工具。

### 1.3 项目目标
- 提供高性能的3D模型加载和渲染功能
- 支持丰富的模型交互和操作
- 实现模型与数据的联动可视化
- 构建跨平台桌面应用，支持Windows、Linux等系统
- 提供良好的用户体验和操作界面

## 2. 系统架构

### 2.1 总体架构
SNAP 3D模型查看器采用Electron + Vue 3 + Three.js的技术架构，构建了一个桌面应用程序：
- **Electron**: 提供跨平台桌面应用框架
- **Vue 3**: 前端页面渲染和状态管理
- **Three.js**: 3D图形渲染与交互
- **MQTT**: 实时数据通信

### 2.2 系统组件
系统主要包含以下核心组件：
1. **主进程(electron-main.js)**: 负责创建应用窗口、管理应用生命周期、处理系统交互
2. **渲染进程(Vue应用)**: 负责UI渲染和用户交互
3. **3D引擎(Three.js)**: 负责3D模型加载、渲染和交互
4. **数据服务**: 通过MQTT协议与后端通信，获取和传输数据
5. **图表组件(ECharts)**: 提供数据可视化支持

### 2.3 数据流
1. 模型数据从服务器加载到客户端
2. 用户操作通过UI发出指令
3. Three.js执行对应的渲染和变换
4. 实时数据通过MQTT从服务器推送到客户端
5. 客户端根据数据更新模型状态和相关图表

## 3. 功能特性

### 3.1 核心功能
- **模型加载与渲染**
  - 支持GLTF/GLB和FBX格式的3D模型
  - 支持模型动态加载和切换
  - 模型自动适配视图

- **模型交互操作**
  - 模型旋转、缩放、平移
  - 部件选择与高亮
  - 模型拆解与合并
  - 视角控制与预设

- **动画控制**
  - 模型动画播放/暂停
  - 动画速度调节
  - 动画序列控制

- **显示选项**
  - 网格显示切换
  - 坐标轴显示切换
  - 包围盒显示切换
  - 材质和颜色修改

- **信息展示**
  - 模型信息显示（顶点数、面片数、材质数、尺寸）
  - 部件详细信息
  - 性能监控（FPS、内存使用）

- **工具功能**
  - 截图保存
  - 数据导出
  - 热键支持

### 3.2 特色功能
- **船舶管理系统(AMS)集成**
  - 与船舶数据系统集成
  - 实时数据可视化
  - 多船型支持（如505型船舶）
  
- **数据监控与分析**
  - 实时数据图表展示
  - 历史数据分析
  - 异常情况警报

- **性能优化**
  - 模型压缩技术(DRACOLoader)
  - 动态LOD(Level of Detail)
  - 按需加载资源

## 4. 技术栈

### 4.1. 前端框架
- **Vue 3**: 前端核心框架
- **TypeScript**: 类型系统
- **Element Plus**: UI组件库
- **Pinia**: 状态管理
- **Vue Router**: 路由管理

### 4.2. 3D渲染
- **Three.js**: 3D图形库
- **GLTF/FBX Loader**: 模型加载器
- **DRACOLoader**: 模型压缩

### 4.3. 数据可视化
- **ECharts**: 图表库
- **Leaflet/MapTiler**: 地图组件

### 4.4. 通信
- **MQTT**: 实时数据通信
- **Axios**: HTTP请求

### 4.5. 桌面应用
- **Electron**: 桌面应用框架
- **Electron Builder**: 打包工具

## 5. 项目结构

```
SNAP-正式/
├── dist/                 # 构建输出目录
│   ├── assets/           # 静态资源
│   ├── index.html        # 入口HTML
│   ├── config.js         # 配置文件
│   ├── mqtt.min.js       # MQTT客户端
│   └── echarts.min.js    # 图表库
├── build/                # 构建资源目录
│   └── logo.*            # 应用图标
├── ele-build/            # Electron构建目录
│   └── ...               # 打包配置与输出
├── node_modules/         # 依赖包
├── electron-main.js      # Electron主进程
├── preload.js            # Electron预加载脚本
├── package.json          # 项目配置
└── README.md             # 项目说明
```

## 6. 开发与部署

### 6.1. 开发环境
- **Node.js**: v12.0以上
- **npm/yarn**: 包管理器
- **IDE推荐**: VS Code

### 6.2. 项目安装
```bash
# 安装依赖
npm install

# 开发模式运行
npm run dev

# 构建Vue应用
npm run build

# 启动Electron应用
npm run electron:serve

# 构建Electron应用
npm run electron:build
```

### 6.3. 打包配置
根据builder-effective-config.yaml的配置，应用支持打包为：
- Windows: NSIS安装包、ZIP压缩包
- Linux: DEB包、Snap包

### 6.4. 部署说明
1. 构建Electron应用获得安装包
2. 分发安装包到目标设备
3. 用户安装并运行应用
4. 配置服务器连接（通过config.js设置）

### 6.5. 网络配置
- 默认连接到`http://192.168.100.89:9990`服务器
- MQTT连接到`92.168.100.89:9990`
- 支持根据不同主机名自动适配服务器地址

## 7. 配置说明

### 7.1. 应用配置
在`config.js`中配置：
- 船型列表和默认船型设置
- 系统信息显示内容
- 服务器连接地址配置
- MQTT服务器配置

### 7.2. 构建配置
- **appId**: cn.sango.aiot.test.app
- **productName**: AMS
- **打包目标**: Windows(nsis, zip), Linux(deb, snap)

## 8. 注意事项与最佳实践

### 8.1. 性能优化
- 大型模型应采用压缩格式
- 优先使用GLB格式（二进制GLTF）
- 合理设置LOD级别
- 及时释放不需要的资源

### 8.2. 3D模型要求
- 确保模型格式正确，无损坏
- 控制模型大小，建议不超过20MB
- 优化模型网格和材质
- 合理设置模型动画

### 8.3. 开发建议
- 使用组件化开发方式
- 遵循Vue 3组合式API最佳实践
- Three.js资源合理释放
- 使用Electron安全最佳实践

## 9. 系统配置要求

### 9.1. 硬件要求
- **处理器**: 支持WebGL的现代CPU
- **显卡**: 支持WebGL 2.0的GPU
- **内存**: 至少4GB RAM，推荐8GB以上
- **存储**: 最少500MB可用空间

### 9.2. 软件要求
- **操作系统**: Windows 10+, Ubuntu 22.04+ 或其他主流Linux发行版
- **其他**: 支持WebGL的现代浏览器核心

## 10. 许可与版权
- 版权所有 © 2022 三顾海事科技
- 应用产品名称: AMS (Advanced Model System/船舶管理系统)
- 使用限制: 未经授权不得分发或修改 